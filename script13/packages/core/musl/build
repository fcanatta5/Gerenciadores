pkgname="musl"
pkgver="1.2.5"
pkgrel=1

# Para musl "nativo", você normalmente já tem binutils/gcc no sistema.
# O requisito funcional aqui é ter headers do kernel em /usr/include (linux-headers).
depends=(linux-headers)

sources=(
  "https://musl.libc.org/releases/musl-${pkgver}.tar.gz::musl-${pkgver}.tar.gz"
)

sha256sums=(
  "a9a118bbe84d8764da0ea0d28b3ab3fae8477fc7e4085d90102b8596fc7c75e4 musl-1.2.5.tar.gz"
)

pre_build() {
  : "${JOBS:=$(nproc 2>/dev/null || echo 4)}"
}

build() {
  # musl faz build in-tree; manter limpo
  make distclean >/dev/null 2>&1 || true

  # Instalação nativa padrão:
  # - /usr para headers/libs "normais"
  # - /lib para loader e libs essenciais (layout correto para musl)
  ./configure \
    --prefix=/usr \
    --syslibdir=/lib

  make -j"$JOBS"
}

install() {
  make DESTDIR="$DESTDIR" install
}
