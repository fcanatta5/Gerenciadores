#!/usr/bin/env bash
# core/bzip2 1.0.8 - build script para adm
# Compatível com musl e bootstrap

NAME="bzip2"
CATEGORY="core"
VERSION="1.0.8"

URL="https://sourceware.org/pub/bzip2/bzip2-1.0.8.tar.gz"
SHA256="ab5a03176ee106d3f0fa90e381da478ddae405918153cca248e682cd0c4a2269"

DEPENDS=""
BUILD_DEPENDS=""

PREFIX="/usr"
BUILD_SYSTEM="make"

pkg_prepare() {
  # Limpa artefatos anteriores (bzip2 é sensível a rebuild)
  make clean >/dev/null 2>&1 || true
}

pkg_build() {
  # Bzip2 não usa configure
  make -j"${JOBS:-1}"
}

pkg_install() {
  # Makefile do bzip2 suporta PREFIX e DESTDIR
  make PREFIX="$PREFIX" DESTDIR="$DESTDIR" install

  # Remove libs estáticas se você não quiser (.a)
  # comente se preferir manter
  rm -f "$DESTDIR$PREFIX/lib/"libbz2.a 2>/dev/null || true
}

pkg_post() {
  :
}
