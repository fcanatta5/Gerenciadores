# busybox
PKGNAME=busybox
PKGVER=1.36.1
PKGREL=1
SECTION=core
ARCH=x86_64

PKGDESC="BusyBox: multi-call binary providing minimal UNIX utilities"
PKGURL="https://busybox.net/"
LICENSE="GPL-2.0-only"

SOURCES="busybox-1.36.1.tar.bz2::https://busybox.net/downloads/busybox-1.36.1.tar.bz2"
SUMTYPE=sha256
SUMS="b8cc24c9574d809e7279c3be349795c5d5ceb6fdf19ca709f80cde50e47de314"

DEPENDS=""
BUILD_DEPENDS="make"

pkg_prepare() {
  cd "$WORKSRC" || exit 1
  make distclean >/dev/null 2>&1 || true

  # Usa config versionada (reprodutível)
  cp "$PKGDIR/files/busybox.config" .config || exit 1

  # Ajusta para a versão atual do BusyBox (sem perguntar nada)
  yes "" | make oldconfig >/dev/null 2>&1 || make oldconfig || exit 1
}

pkg_build() {
  cd "$WORKSRC" || exit 1
  make -j"$ADM_JOBS" || exit 1
}

pkg_install() {
  cd "$WORKSRC" || exit 1
  make CONFIG_PREFIX="$DESTDIR" install || exit 1
}
