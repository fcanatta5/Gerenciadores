PKGNAME=musl
PKGVER=1.2.5
PKGREL=1
SECTION=core
ARCH=x86_64

PKGDESC="musl libc (C standard library implementation)"
PKGURL="https://musl.libc.org/"
LICENSE="MIT"

SOURCES="musl-1.2.5.tar.gz::https://musl.libc.org/releases/musl-1.2.5.tar.gz"
SUMTYPE=sha256
SUMS="a9a118bbe84d8764da0ea0d28b3ab3fae8477fc7e4085d90102b8596fc7c75e4"

DEPENDS=""
BUILD_DEPENDS="make"

# Evita strip do loader/CRT/libc
ADM_STRIP=0
export ADM_STRIP

pkg_prepare() {
  cd "$WORKSRC" || exit 1
  make distclean >/dev/null 2>&1 || true
}

pkg_build() {
  cd "$WORKSRC" || exit 1
  ./configure --prefix=/usr --syslibdir=/lib || exit 1
  make -j"$ADM_JOBS" || exit 1
}

pkg_install() {
  cd "$WORKSRC" || exit 1
  make DESTDIR="$DESTDIR" install || exit 1
}
